import {
  date,
  readonly,
  field,
  relation,
  json,
  children,
  nochange,
  text,
} from '@nozbe/watermelondb/decorators';
import {Model} from '@nozbe/watermelondb';

class LnNode extends Model {
  static table = 'ln_node';
  static associations = {
    comments: {type: 'has_many', foreignKey: 'pubkey'},
  };
  @readonly @date('created_at') createdAt;
  @readonly @date('updated_at') updatedAt;
  @nochange @field('pubkey') pubkey;
  @text('label') label;
  @field('alias') alias;
  @children('bolt11_records') transactions;
}

class LnWalletBolt11Records extends Model {
  static table = 'bolt11_records';
  static associations = {
    posts: {type: 'belongs_to', key: 'pubkey'},
  };
  @readonly @date('created_at') createdAt;
  @field('type') type;
  @nochange @field('bolt11') bolt11;
  @field('decoded_bolt11') decodedBolt11;
  @json('meta') meta;
  @relation('ln_node', 'pubkey') walletPubkey;
}

export {LnNode, LnWalletBolt11Records};
